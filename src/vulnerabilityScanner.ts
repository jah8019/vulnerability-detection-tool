import { VulnerabilityReport } from "./contracts/vulnerabilityReport";
import { Vulnerability } from "./interfaces/vulnerability";
import { BufferOverflow } from "./vulnerabilities/BufferOverflow";
import { SQLInjection } from "./vulnerabilities/SQLInjection";
import { XSS } from "./vulnerabilities/XSS";

export class VulnerabilityScanner {
  private vulnerabilities: Vulnerability[];

  constructor(configPath: string) {
    this.vulnerabilities = [
      new BufferOverflow(configPath),
      new XSS(configPath),
      new SQLInjection(configPath)
    ];
  }

  scan(code: string, filePath: string): VulnerabilityReport[] {
    const reports: VulnerabilityReport[] = [];
    for (const vulnerability of this.vulnerabilities) {
      reports.push(...vulnerability.detect(code, filePath));
    }
    return reports;
  }
}
