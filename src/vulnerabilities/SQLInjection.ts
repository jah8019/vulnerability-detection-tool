import { VulnerabilityReport } from '../contracts/vulnerabilityReport';
import { VulnerabilityType } from '../interfaces/vulnerability';
import { BaseVulnerability } from './BaseVulnerability';

export class SQLInjection extends BaseVulnerability {
    constructor(configPath: string) {
        super(configPath, 'sqlInjection');
    }

    detect(code: string, filePath: string): VulnerabilityReport[] {
        // Use the common pattern detection method for SQL injections
        return this.detectPatterns(code, 'sqlPattern', filePath, VulnerabilityType.SQLInjection);
    }
}
